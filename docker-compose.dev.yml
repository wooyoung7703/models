version: "3.9"
services:
  backend:
    environment:
      - LOG_LEVEL=DEBUG
      # Enable background loops (collector/resampler/predictor) for real-time data.
      # Set to 1 to disable them during fast unit tests.
      - DISABLE_BACKGROUND_LOOPS=0
    # Mount source for fast iteration
    volumes:
      - ./backend:/app/backend
      - ./backend/data:/app/backend/data
    # Enable auto-reload in dev
    command: [
      "python",
      "-m",
      "uvicorn",
      "backend.app.main:app",
      "--host","0.0.0.0",
      "--port","8000",
      "--reload"
    ]

  # Frontend dev is served by the same Nginx image as prod.
  # Edit code locally, then rebuild `models-frontend` via `docker compose build frontend` when needed.
